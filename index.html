<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Transient Demo</title>
  <script src="https://unpkg.com/tone@latest/build/Tone.js"></script>
</head>
<body>

  <button id="play">Play Transient</button>
  <br><br>

  <!-- CLICK controls -->
  <h3>Click</h3>
  <button id="muteClick">Mute Click</button>
  <input id="volClick" type="range" min="-40" max="0" value="-10" />
  <br><br>

  <!-- SCRAPE controls -->
  <h3>Scrape</h3>
  <button id="muteScrape">Mute Scrape</button>
  <input id="volScrape" type="range" min="-40" max="0" value="-10" />

  <script>
    // === CLICK signal chain ===
    const clickNoise = new Tone.Noise("white");
    const clickFilter = new Tone.Filter({ type: "highpass", frequency: 4000 });
    const clickEnv = new Tone.AmplitudeEnvelope({
      attack: 0.0001,
      decay: 0.002,
      sustain: 0,
      release: 0.001
    });

    const clickVol = new Tone.Volume(-10).toDestination();

    clickNoise.connect(clickFilter);
    clickFilter.connect(clickEnv);
    clickEnv.connect(clickVol);

    // === SCRAPE signal chain ===
    const scrapeNoise = new Tone.Noise("white");
    const scrapeFilter = new Tone.Filter({ type: "highpass", frequency: 2000 });
    const scrapeEnv = new Tone.AmplitudeEnvelope({
      attack: 0.0001,
      decay: 0.03,
      sustain: 0,
      release: 0.005
    });

    const scrapeVol = new Tone.Volume(-10).toDestination();

    scrapeNoise.connect(scrapeFilter);
    scrapeFilter.connect(scrapeEnv);
    scrapeEnv.connect(scrapeVol);

    // === UI: mute buttons ===
    document.getElementById("muteClick").onclick = () => {
      clickVol.mute = !clickVol.mute;
    };

    document.getElementById("muteScrape").onclick = () => {
      scrapeVol.mute = !scrapeVol.mute;
    };

    // === UI: volume sliders ===
    document.getElementById("volClick").oninput = e => {
      clickVol.volume.value = e.target.value;
    };

    document.getElementById("volScrape").oninput = e => {
      scrapeVol.volume.value = e.target.value;
    };

    // === PLAY both transients ===
    document.getElementById("play").onclick = async () => {
      await Tone.start();
      const now = Tone.now();

      // Click
      clickNoise.start(now);
      clickEnv.triggerAttack(now);
      clickNoise.stop(now + 0.01);

      // Scrape
      scrapeNoise.start(now);
      scrapeEnv.triggerAttack(now);
      scrapeNoise.stop(now + 0.05);
    };
  </script>
</body>
</html>
